---
date: '2024-11-20'
description: 'ç†è§£ä»€ä¹ˆæ˜¯FabricJSï¼Œæ›´å¥½åœ°åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨FabricJS'
title: ç®€ä»‹ï¼š3.ç»„ã€åºåˆ—åŒ–ã€å­ç±»åŒ–
sidebar:
  order: 5
---
import { FileTree, Steps } from '@astrojs/starlight/components';

æˆ‘ä»¬å·²ç»è¦†ç›–äº†å¤§å¤šæ•°çš„åŸºæœ¬çŸ¥è¯†åœ¨è¿™ä¸ªç³»åˆ—çš„ [ç¬¬1éƒ¨åˆ†](/docs/getting-started/fabric-intro-part-1/) å’Œ [ç¬¬2éƒ¨åˆ†](/docs/getting-started/fabric-intro-part-2/) ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬ç©ç‚¹é«˜çº§çš„!

### ç»„

![](/article_assets/8.png)

æˆ‘ä»¬é¦–å…ˆè¦è°ˆè®ºçš„æ˜¯ç»„(groups)ã€‚ç»„æ˜¯Fabricæœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ã€‚å®ƒä»¬çš„ç¡®åƒæ˜¯å¬èµ·æ¥çš„æ ·å­â€”ä¸€ç§å°†ä»»ä½•Fabricå¯¹è±¡åˆ†ç»„ä¸ºå•ä¸ªå®ä½“çš„ç®€å•æ–¹æ³•ã€‚

æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿå½“ç„¶æ˜¯è¦å°†è¿™äº›å¯¹è±¡ä½œä¸ºä¸€ä¸ªå•å…ƒæ¥ä½¿ç”¨ï¼

è¿˜è®°å¾—å¦‚ä½•ç”¨é¼ æ ‡å°†ç”»å¸ƒä¸Šä»»æ„æ•°é‡çš„Fabricå¯¹è±¡ç»„åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªé€‰æ‹©å—ï¼Ÿåˆ†ç»„åï¼Œæ‰€æœ‰å¯¹è±¡éƒ½å¯ä»¥ä¸€èµ·ç§»åŠ¨ç”šè‡³ä¿®æ”¹ã€‚ä»–ä»¬ç»„æˆä¸€ä¸ªå°ç»„ã€‚æˆ‘ä»¬å¯ä»¥ç¼©æ”¾è¯¥ç»„ï¼Œæ—‹è½¬ç”šè‡³æ›´æ”¹å…¶å¤–è§‚å±æ€§-é¢œè‰²ï¼Œé€æ˜åº¦ï¼Œè¾¹æ¡†ç­‰ã€‚

è¿™æ­£æ˜¯ç»„çš„ç”¨é€”ï¼Œæ¯å½“ä½ åœ¨ç”»å¸ƒä¸Šçœ‹åˆ°è¿™æ ·çš„é€‰æ‹©æ—¶ï¼ŒFabricéƒ½ä¼šåœ¨å¹•åéšå¼åˆ›å»ºä¸€ç»„å¯¹è±¡ã€‚ä»…å…è®¸ä»¥ç¼–ç¨‹æ–¹å¼æä¾›ä½¿ç”¨ç»„çš„æƒé™ã€‚è¿™å°±æ˜¯fabricç»„çš„é­…åŠ›ï¼Œæ›´å¤šç²¾å½©å®æˆ˜ï¼Œè¯·å…³æ³¨[webmote](https://blog.csdn.net/codeex)ã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç”±2ä¸ªå¯¹è±¡ç»„æˆçš„ç»„ï¼Œå³åœ†åœˆå’Œæ–‡æœ¬ï¼š

```js
// åˆ›å»ºä¸€ä¸ªåœ†å½¢å¯¹è±¡
const circle = new fabric.Circle({
  radius: 100,
  fill: '#eef',
  scaleY: 0.5,
  originX: 'center',
  originY: 'center'
});

// åˆ›å»ºä¸€ä¸ªæ–‡æœ¬å¯¹è±¡
const text = new fabric.FabricText('hello world', {
  fontSize: 30,
  originX: 'center',
  originY: 'center'
});

// åˆ›å»ºä¸€ä¸ªåŒ…å«åœ†å½¢å’Œæ–‡æœ¬çš„ç»„åˆå¯¹è±¡
const group = new fabric.Group([circle, text], {
  left: 150,
  top: 100,
  angle: -10
});

// å°†ç»„åˆå¯¹è±¡æ·»åŠ åˆ°ç”»å¸ƒ
canvas.add(group);


```

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªâ€œ hello worldâ€æ–‡æœ¬å¯¹è±¡ã€‚è®¾ç½®originXå’ŒoriginYä»¥'center'è®©å®ƒåœ¨ç»„å†…å±…ä¸­; é»˜è®¤æƒ…å†µä¸‹ï¼Œç»„æˆå‘˜ç›¸å¯¹äºç»„çš„å·¦ä¸Šè§’å®šå‘ã€‚ç„¶åï¼Œä»¥100pxåŠå¾„çš„åœ†åœˆï¼Œå¡«å……â€œ #eefâ€é¢œè‰²å¹¶å‚ç›´å‹ç¼©ï¼ˆscaleY = 0.5ï¼‰ã€‚ç„¶åfabric.Groupï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹ï¼Œå°†è¿™ä¸¤ä¸ªå¯¹è±¡ä»¥æ•°ç»„å½¢å¼ä¼ ç»™å®ƒï¼Œå¹¶å°†å…¶ä½ç½®è®¾ç½®ä¸º150/100å’Œ-10è§’åº¦ã€‚æœ€åï¼Œå°†è¯¥ç»„æ·»åŠ åˆ°ç”»å¸ƒä¸Šï¼Œå°±åƒå…¶ä»–ä»»ä½•å¯¹è±¡ä¸€æ ·ï¼ˆç”¨`canvas.add()`ï¼‰ã€‚

ç§ï¼ä½ ä¼šåœ¨ç”»å¸ƒä¸Šçœ‹åˆ°ä¸€ä¸ªçœ‹èµ·æ¥åƒæ¤­åœ†çš„å¯¹è±¡ã€‚æ³¨æ„ï¼Œå¦‚ä½•ä¿®æ”¹è¯¥å¯¹è±¡ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•åœ°æ›´æ”¹äº†ä¸€ä¸ªç»„çš„å±æ€§ï¼Œä¸ºå…¶æä¾›äº†è‡ªå®šä¹‰çš„leftï¼Œtopå’Œangleå€¼ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥å°†æ­¤å¯¹è±¡ä½œä¸ºå•ä¸ªå®ä½“ä½¿ç”¨ã€‚

![](/article_assets/3_1.png)

ç°åœ¨æˆ‘ä»¬åœ¨ç”»å¸ƒä¸Šæœ‰äº†ä¸€ä¸ªç»„ï¼Œè®©æˆ‘ä»¬å¯¹å…¶è¿›è¡Œä¸€äº›æ›´æ”¹ï¼š

```js
// in order to use setFill named setter, you need to add the optional named setter/getter
// code from src/util/named\_accessors.mixins.js
group.item(0).set('fill', 'red');
group.item(1).set({
  text: 'trololo',
  fill: 'white'
});
```

å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæˆ‘ä»¬æ­£åœ¨é€šè¿‡`item()`æ–¹æ³•è®¿é—®ç»„ä¸­çš„å•ä¸ªå¯¹è±¡ï¼Œå¹¶ä¿®æ”¹å®ƒä»¬çš„å±æ€§ã€‚ç¬¬ä¸€ä¸ªå¯¹è±¡æ˜¯å‹ç¼©çš„åœ†åœˆï¼Œç¬¬äºŒä¸ªå¯¹è±¡æ˜¯æ–‡æœ¬ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š

![](/article_assets/3_2.png)

ä½ ç°åœ¨å¯èƒ½å·²ç»æ³¨æ„åˆ°çš„ä¸€ä»¶äº‹å¾ˆé‡è¦ï¼Œé‚£å°±æ˜¯ç»„ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½ç›¸å¯¹äºç»„çš„ä¸­å¿ƒå®šä½ã€‚å½“æˆ‘ä»¬æ›´æ”¹æ–‡æœ¬å¯¹è±¡çš„æ–‡æœ¬æ—¶ï¼Œå³ä½¿æ›´æ”¹äº†å®½åº¦ï¼Œå®ƒä¹Ÿä¿æŒå±…ä¸­ã€‚å¦‚æœä½ ä¸å¸Œæœ›å‡ºç°è¿™ç§æƒ…å†µï¼Œåˆ™éœ€è¦æŒ‡å®šå¯¹è±¡çš„left/topåæ ‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†æ ¹æ®è¿™äº›åæ ‡å°†å®ƒä»¬åˆ†ç»„åœ¨ä¸€èµ·ã€‚

è®©æˆ‘ä»¬åˆ›å»º3ä¸ªåœ†å¹¶å¯¹å…¶è¿›è¡Œåˆ†ç»„ï¼Œä½¿å®ƒä»¬å½¼æ­¤æ°´å¹³æ”¾ç½®ï¼š

```js
var circle1 = new fabric.Circle({
  radius: 50,
  fill: 'red',
  left: 0
});
var circle2 = new fabric.Circle({
  radius: 50,
  fill: 'green',
  left: 100
});
var circle3 = new fabric.Circle({
  radius: 50,
  fill: 'blue',
  left: 200
});

var group = new fabric.Group([ circle1, circle2, circle3 ], {
  left: 200,
  top: 100
});

canvas.add(group);
```

![](/article_assets/3_3.png)

ä½¿ç”¨ç»„æ—¶è¦è®°ä½çš„å¦ä¸€ä»¶äº‹æ˜¯å¯¹è±¡çš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸å›¾åƒç»„æˆç»„æ—¶ï¼Œéœ€è¦ç¡®ä¿è¿™äº›å›¾åƒå·²å®Œå…¨åŠ è½½ã€‚ç”±äºFabricå·²ç»æä¾›äº†ç”¨äºç¡®ä¿åŠ è½½å›¾åƒçš„è¾…åŠ©æ–¹æ³•ï¼Œå› æ­¤è¿™å˜å¾—ç›¸å½“å®¹æ˜“ï¼š

```js
// Ensure that the canvas is created first
const canvas = new fabric.Canvas('myCanvas');

// A function to load and scale an image
async function loadImage(url, scaleFactor, left, top) {
  const img = await fabric.FabricImage.fromURL(url);
  img.scale(scaleFactor).set({ left, top });
  return img;
}

// Main function to load images and create the group
async function createImageGroup() {
  // Load and scale images asynchronously
  const img1 = await loadImage('/assets/pug.jpg', 0.1, 100, 100);
  const img2 = await loadImage('/assets/pug.jpg', 0.1, 175, 175);
  const img3 = await loadImage('/assets/pug.jpg', 0.1, 250, 250);

  // Create a group of images
  const group = new fabric.Group([img1, img2, img3], { left: 200, top: 200 });

  // Add the group to the canvas
  canvas.add(group);
}

// Call the function to create the image group
createImageGroup();

```

![](/article_assets/3_4.png)

é‚£ä¹ˆåœ¨ä¸groupsä¸€èµ·å·¥ä½œæ—¶è¿˜æœ‰å“ªäº›å…¶ä»–æ–¹æ³•å¯ç”¨ï¼Ÿæœ‰`getObjects()`æ–¹æ³•ï¼Œå…¶å·¥ä½œåŸç†ä¸ä¹‹å®Œå…¨ç›¸åŒï¼Œ`fabric.Canvas#getObjects()`å¹¶è¿”å›ä¸€ç»„ä¸­æ‰€æœ‰å¯¹è±¡çš„æ•°ç»„ã€‚æœ‰`size()`ä»£è¡¨ç»„ä¸­çš„æ‰€æœ‰å¯¹è±¡çš„æ•°é‡ã€‚è¿˜æœ‰`contains()`ï¼Œå®ƒå…è®¸æ£€æŸ¥ç‰¹å®šå¯¹è±¡æ˜¯å¦åœ¨groupä¸­ã€‚è¿˜æœ‰`item()`ï¼Œæˆ‘ä»¬å‰é¢çœ‹åˆ°çš„ï¼Œå…è®¸åœ¨ä¸€ä¸ªgroupä¸­æ£€ç´¢ç‰¹å®šå¯¹è±¡ã€‚è¿˜æœ‰`forEachObject()`ï¼Œå†æ¬¡åæ˜ `fabric.Canvas#forEachObject`ï¼Œåªæ˜¯ç›¸å¯¹äºç»„å¯¹è±¡ã€‚æœ€åï¼Œæœ‰ä¸€ç§`add()`å’Œ`remove()`æ–¹æ³•å¯ä»¥ç›¸åº”åœ°ä»ç»„ä¸­æ·»åŠ å’Œåˆ é™¤å¯¹è±¡ã€‚

ä½ å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ä»groupä¸­æ·»åŠ /åˆ é™¤å¯¹è±¡-æ›´æ–°æˆ–ä¸æ›´æ–°group dimensions/positionã€‚æˆ‘ä»¬å»ºè®®ä½¿ç”¨æ›´æ–°dimensionsï¼Œé™¤éä½ æ­£åœ¨æ‰§è¡Œæ‰¹å¤„ç†æ“ä½œï¼Œå¹¶ä¸”åœ¨å¤„ç†è¿‡ç¨‹ä¸­ç»„çš„å®½åº¦/é«˜åº¦ä¸å­˜åœ¨é—®é¢˜æ—¶æ²¡æœ‰é—®é¢˜ã€‚

<Steps>
1. è¦å°†çŸ©å½¢æ·»åŠ åˆ°ç»„çš„ä¸­å¿ƒï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

    ```js
    group.add(new fabric.Rect({
      ...
      originX: 'center',
      originY: 'center'
    }));
    ```

2. è¦åœ¨ç»„ä¸­å¿ƒä¹‹å¤–æ·»åŠ 100pxçš„çŸ©å½¢ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

    ```js
    group.add(new fabric.Rect({
      ...
      left: 100,
      top: 100,
      originX: 'center',
      originY: 'center'
    }));
    ```

3. è¦å°†çŸ©å½¢æ·»åŠ åˆ°ç»„çš„ä¸­å¿ƒå¹¶æ›´æ–°ç»„çš„å°ºå¯¸ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

    ```js
    group.addWithUpdate(new fabric.Rect({
      ...
      left: group.get('left'),
      top: group.get('top'),
      originX: 'center',
      originY: 'center'
    }));
    ```

4. è¦åœ¨è·ç»„ä¸­å¿ƒ100pxå¤„æ·»åŠ çŸ©å½¢å¹¶æ›´æ–°ç»„çš„å°ºå¯¸ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

    ```js
    group.addWithUpdate(new fabric.Rect({
      ...
      left: group.get('left') + 100,
      top: group.get('top') + 100,
      originX: 'center',
      originY: 'center'
    }));
    ```

5. æœ€åï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ç”»å¸ƒä¸Šå·²ç»å­˜åœ¨çš„å¯¹è±¡åˆ›å»ºä¸€ä¸ªç»„ï¼Œåˆ™éœ€è¦é¦–å…ˆå…‹éš†å®ƒä»¬ï¼š

    ```js
    // create a group with copies of existing (2) objects
    var group = new fabric.Group([
      canvas.item(0).clone(),
      canvas.item(1).clone()
    ]);

    // remove all objects and re-render
    canvas.clear().renderAll();

    // add group onto canvas
    canvas.add(group);
    ```

</Steps>

### åºåˆ—åŒ–

ä¸€æ—¦å¼€å§‹æ„å»ºæŸç§æœ‰çŠ¶æ€çš„åº”ç”¨ç¨‹åºï¼ˆå¯èƒ½å…è®¸ç”¨æˆ·å°†ç”»å¸ƒå†…å®¹çš„ç»“æœä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šï¼Œæˆ–å°†å†…å®¹æµå¼ä¼ è¾“åˆ°å…¶ä»–å®¢æˆ·ç«¯ï¼‰ï¼Œä½ å°†éœ€è¦**canvasåºåˆ—åŒ–**ã€‚å¦‚æœä»ç„¶è¦å‘é€ç”»å¸ƒå†…å®¹ï¼Ÿä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæœ‰ä¸€ä¸ªé€‰é¡¹å¯ä»¥å°†ç”»å¸ƒå¯¼å‡ºåˆ°å›¾åƒã€‚ä½†æ˜¯ä¸Šä¼ å›¾ç‰‡åˆ°æœåŠ¡å™¨æ— ç–‘æ˜¯ç›¸å½“å ç”¨å¸¦å®½çš„ï¼Œè®ºå¤§å°ï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ä»¥æ¯”å¾—è¿‡æ–‡æœ¬äº†ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆFabricä¸ºcanvasç”»å¸ƒåºåˆ—åŒ–/ååºåˆ—åŒ–æä¾›äº†æå¥½çš„æ”¯æŒã€‚

#### toObject, toJSON æ–¹æ³•

Fabricä¸­çš„canvasåºåˆ—åŒ–æ–¹æ³•ä¸»è¦æ˜¯`toObjectï¼ˆï¼‰`å’Œ`toJSONï¼ˆï¼‰`æ–¹æ³•ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œé¦–å…ˆåºåˆ—åŒ–ä¸€ä¸ªç©ºçš„ç”»å¸ƒï¼š

```js
var canvas = new fabric.Canvas('c');
JSON.stringify(canvas); // '{"objects":[],"background":"rgba(0, 0, 0, 0)"}'
```

æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ES5 `JSON.stringify()`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨ä¼ é€’çš„å¯¹è±¡ä¸Šéšå¼è°ƒç”¨`toJSON`æ–¹æ³•ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚ç”±äºFabricä¸­çš„canvaså®ä¾‹å…·æœ‰`toJSON`æ–¹æ³•ï¼Œå°±åƒæˆ‘ä»¬è°ƒç”¨`JSON.stringify(canvas.toJSON())`ä¸€æ ·ã€‚ 

è¯·æ³¨æ„ï¼Œè¿”å›çš„å­—ç¬¦ä¸²ä»£è¡¨ç©ºcanvasã€‚å®ƒé‡‡ç”¨JSONæ ¼å¼ï¼Œå¹¶ä¸”åŸºæœ¬ä¸Šç”±â€œobjectsâ€å’Œâ€œbackgroundâ€å±æ€§ç»„æˆã€‚ â€œobjectsâ€å½“å‰ä¸ºç©ºï¼Œå› ä¸ºç”»å¸ƒä¸Šæ²¡æœ‰ä»»ä½•å†…å®¹ï¼Œå¹¶ä¸”èƒŒæ™¯å…·æœ‰é»˜è®¤çš„é€æ˜å€¼ï¼ˆâ€œ rgbaï¼ˆ0ï¼Œ0ï¼Œ0ï¼Œ0ï¼‰â€ï¼‰ã€‚ 

è®©æˆ‘ä»¬ä¸ºç”»å¸ƒæä¾›ä¸åŒçš„èƒŒæ™¯ï¼Œçœ‹çœ‹æƒ…å†µå¦‚ä½•å˜åŒ–ï¼š

```js
canvas.backgroundColor = 'red';
JSON.stringify(canvas); // '{ "objects": [], "background": "red" }'
```

æ­£å¦‚ä½ æ‰€æ–™ï¼Œç”»å¸ƒè¡¨ç¤ºç°åœ¨åæ˜ äº†æ–°çš„èƒŒæ™¯è‰²ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€äº›å¯¹è±¡ï¼

```js
canvas.add(new fabric.Rect({
  left: 50,
  top: 50,
  height: 20,
  width: 20,
  fill: 'green'
}));
console.log(JSON.stringify(canvas));
```
..æ—¥å¿—è¾“å‡ºå¦‚ä¸‹:
```json
{"objects":[{"type":"rect","left":50,"top":50,"width":20,"height":20,"fill":"green","overlayFill":null,"stroke":null,"strokeWidth":1,"strokeDashArray":null,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"selectable":true,"hasControls":true,"hasBorders":true,"hasRotatingPoint":false,"transparentCorners":true,"perPixelTargetFind":false,"rx":0,"ry":0}],"background":"rgba(0, 0, 0, 0)"}
```
ğŸ˜²å“‡å“¦ï¼ğŸ˜²ä¹ä¸€çœ‹å˜åŒ–å¾ˆå¤§ï¼Œä½†ä»”ç»†çœ‹ï¼Œæˆ‘ä»¬å‘ç°æ–°æ·»åŠ çš„å¯¹è±¡ï¼Œç°åœ¨æ˜¯â€œobjectsâ€æ•°ç»„çš„ä¸€éƒ¨åˆ†ï¼Œåºåˆ—åŒ–ä¸ºJSONã€‚è¯·æ³¨æ„ï¼Œå®ƒçš„è¡¨ç¤ºæ–¹å¼åŒ…å«äº†å®ƒçš„æ‰€æœ‰è§†è§‰ç‰¹å¾-å·¦ã€ä¸Šã€å®½ã€é«˜ã€å¡«å……ã€ç¬”åˆ’ç­‰ç­‰ã€‚
å¦‚æœæˆ‘ä»¬è¦æ·»åŠ å¦ä¸€ä¸ªå¯¹è±¡ï¼ˆä¾‹å¦‚ï¼ŒçŸ©å½¢æ—è¾¹çš„ä¸€ä¸ªçº¢è‰²åœ†ï¼‰ï¼Œä½ å°†çœ‹åˆ°è¡¨ç¤ºæ–¹å¼ç›¸åº”åœ°å‘ç”Ÿäº†å˜åŒ–ï¼š

```js
canvas.add(new fabric.Circle({
  left: 100,
  top: 100,
  radius: 50,
  fill: 'red'
}));
console.log(JSON.stringify(canvas));
```
..æ—¥å¿—è¾“å‡ºå¦‚ä¸‹ï¼š

```json
{"objects":[{**"type":"rect"**,"left":50,"top":50,"width":20,"height":20,"fill":"green","overlayFill":null,"stroke":null,"strokeWidth":1,"strokeDashArray":null,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"selectable":true,"hasControls":true,"hasBorders":true,"hasRotatingPoint":false,"transparentCorners":true,"perPixelTargetFind":false,"rx":0,"ry":0},{**"type":"circle"**,"left":100,"top":100,"width":100,"height":100,"fill":"red","overlayFill":null,"stroke":null,"strokeWidth":1,"strokeDashArray":null,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"selectable":true,"hasControls":true,"hasBorders":true,"hasRotatingPoint":false,"transparentCorners":true,"perPixelTargetFind":false,"radius":50}],"background":"rgba(0, 0, 0, 0)"}
```
æˆ‘çªå‡ºæ˜¾ç¤ºäº†`â€œ typeâ€ï¼šâ€œ rectâ€`å’Œ`â€œ typeâ€ï¼šâ€œ circleâ€`éƒ¨åˆ†ï¼Œä»¥ä¾¿ä½ å¯ä»¥æ›´å¥½åœ°çœ‹åˆ°è¿™äº›å¯¹è±¡çš„ä½ç½®ã€‚å°½ç®¡ä¸€å¼€å§‹çœ‹èµ·æ¥å¯èƒ½æœ‰å¾ˆå¤šè¾“å‡ºï¼Œä½†æ˜¯ä¸å›¾åƒåºåˆ—åŒ–ç›¸æ¯”ï¼Œè¿™æ²¡ä»€ä¹ˆã€‚

ä¸ºäº†è¿›è¡Œæ¯”è¾ƒï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ç”¨`canvas.toDataURL('png')`è·å¾—çš„å­—ç¬¦ä¸²çš„å¤§çº¦1/10(!)ã€‚

```
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAK8CAYAAAAXo9vkAAAgAElEQVR4Xu3dP4xtBbnG4WPAQOQ2YBCLK1qpoQE1/m+NVlCDwUACicRCEuysrOwkwcJgAglEItRQaWz9HxEaolSKtxCJ0FwMRIj32zqFcjm8e868s2fNWo/Jygl+e397rWetk5xf5pyZd13wPwIECBAgQIAAAQIECBxI4F0H+hwfQ4AAAQIECBAgQIAAgQsCxENAgAABAgQIECBAgMDBBATIwah9EAECBAgQIECAAAECAsQzQIAAAQIECBAgQIDAwQQEyMGofRABAgQIECBAgAABAgLEM0CAAAECBAgQIECAwMEEBMjBqH0QAQIECBAgQIAAAQICxDNAgAABAgQIECBAgMDBBATIwah9EAECBAgQIECAAAECAsQzQIAAAQIECBAgQIDAwQQEyMGofRABAgQIECBAgAABAgLEM0CAAAECBAgQIECAwMEEBMjBqH0QAQIECBAgQIAAAQICxDNAgAABAgQIECBAgMDBBATIwah9EAECBAgQIECAAAECAsQzQIAAAQIECBAgQIDAwQQEyMGofRABAgQIECBAgAABAgLEM0CAAAECBAgQIECAwMEEBMjBqH0QAQIECBAgQIAAAQICxDNAgAABAgQIECBAgMDBBATIwah9EAECBAgQIECAAAECAsQzQIAAAQIECBAgQIDAwQQEyMGofRABAgQIECBAgAABAgLEM0CAAAECBAgQIECAwMEEBMjBqH0QAQIECBAgQIAAAQICxDNAgAABAgQIECBAgMDBBATIwah9EAECBAgQIECAAAECAsQzQIAAAQIECBAgQIDAwQQEyMGofRABAgQIECBAgAABAgLEM0CAAAECBAgQIECAwMEEBMjBqH0QAQIECBAgQIAAAQICxDNAgAABAgQIECBAgMDBBATIwah9EAECBAgQIECAAAECAsQzQIAAAQIECBAgQIDAwQQEyMGofRABAgQIECBAgAABAgLEM0CAAAECBAgQIECAwMEEBMjBqH0QAQIECBAgQIAAAQICxDNAgAABAgQIECBAgMDBBATIwah9EAECBAgQIECAAAECyw+Qb134R/U2fevC8q+5esGWESBAgAABAgQIEFiOwPL/MC5AlvO0OBMCBAgQIECAAAECJxQQICcE9HYCBAgQIECAAAECBPYXECD7W3klAQIECBAgQIAAAQInFBAgJwT0dgIECBAgQIAAAQIE9hcQIPtbeSUBAgQIECBAgAABAicUECAnBPR2AgQIECBAgAABAgT2FxAg+1t5JQECBAgQIECAAAECJxQQICcE9HYCBAgQIECAAAECBPYXECD7W3klAQIECBAgQIAAAQInFBAgJwTc9+3z49yvmNd+dI7PzPHJOW6Y4wNzXD3HlXNc9pZdb85/vzbHK3P8aY7n5vj1HL+Y43dz417f97O9jgABAgQIECBAgMBSBATIKd2JCY5dWNwyx5fn+PwcV5U/6tXZ99M5fjjHk3Mjd6HifwQIECBAgAABAgQWLSBAirdnouP6WXfvHHfOcU1x9T6rXp4XPTLHA3NTX9jnDV5DgAABAgQIECBA4NACAuSE4hMdl8+Kr83xzTmuO+G61ttfnEXfnuN7c4PfaC21hwABAgQIECBAgMBJBQTIJQpOeFw7b71/jtsvccWh3vbYfNB9c6NfOtQH+hwCBAgQIECAAAECFxMQIMd8No7C4+F5283HfOtZv/ypOYG7hMhZ3wafT4AAAQIECBDYtoAA2fP+H/1Vqwd3f4jf8y1Lfdkunu7xV7OWenucFwECBAgQIEBg3QICZI/7O/Fxx7xs9wf3t36r3D3evciX7L7F7+6rIY8u8uycFAECBAgQIE

...è¿˜æœ‰å¾ˆå¤šå­—ç¬¦æœªæ˜¾ç¤º...
```

ä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆè¿˜ä¼šæœ‰`fabric.Canvasï¼ƒtoObject`ã€‚
å¾ˆç®€å•ï¼Œ`toObject`ä»…ä»¥å®é™…å¯¹è±¡çš„å½¢å¼è¿”å›ä¸`toJSON`ç›¸åŒçš„è¡¨ç¤ºå½¢å¼ï¼Œè€Œæ²¡æœ‰å­—ç¬¦ä¸²åºåˆ—åŒ–ã€‚ä¾‹å¦‚ï¼Œä»¥è¾ƒæ—©çš„ä»…å¸¦æœ‰ç»¿è‰²çŸ©å½¢çš„ç”»å¸ƒä¸ºä¾‹ï¼Œ`canvas.toObject()`çš„è¾“å‡ºæ˜¯è¿™æ ·çš„ï¼š

```json
{ "background" : "rgba(0, 0, 0, 0)",
  "objects" : [
    {
      "angle" : 0,
      "fill" : "green",
      "flipX" : false,
      "flipY" : false,
      "hasBorders" : true,
      "hasControls" : true,
      "hasRotatingPoint" : false,
      "height" : 20,
      "left" : 50,
      "opacity" : 1,
      "overlayFill" : null,
      "perPixelTargetFind" : false,
      "scaleX" : 1,
      "scaleY" : 1,
      "selectable" : true,
      "stroke" : null,
      "strokeDashArray" : null,
      "strokeWidth" : 1,
      "top" : 50,
      "transparentCorners" : true,
      "type" : "rect",
      "width" : 20
    }
  ]
}
```
å¦‚ä½ æ‰€è§ï¼Œ`toJSON`è¾“å‡ºæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åŒ–çš„`toObject`è¾“å‡ºã€‚ç°åœ¨ï¼Œæœ‰è¶£çš„æ˜¯ï¼ˆæœ‰ç”¨çš„ï¼ï¼‰äº‹æƒ…æ˜¯`toObject`çš„è¾“å‡ºæ—¢èªæ˜åˆæ‡’ã€‚ä½ åœ¨â€œobjectsâ€æ•°ç»„ä¸­çœ‹åˆ°çš„æ˜¯è¿­ä»£æ‰€æœ‰ç”»å¸ƒå¯¹è±¡å¹¶å°†å®ƒä»¬å§”æ‰˜ç»™å®ƒä»¬è‡ªå·±çš„`toObject`æ–¹æ³•çš„ç»“æœã€‚` fabric.Path`æœ‰è‡ªå·±çš„`toObject` â€”è¿”å›è·¯å¾„çš„â€œpointsâ€æ•°ç»„ï¼Œ`fabric.Image`æœ‰è‡ªå·±çš„`toObject` â€”è¿”å›å›¾åƒçš„â€œ srcâ€å±æ€§ã€‚ä»¥ä¸€ç§çœŸæ­£çš„é¢å‘å¯¹è±¡çš„æ–¹å¼ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½å¯ä»¥åºåˆ—åŒ–è‡ªå·±ã€‚ 

è¿™æ„å‘³ç€ï¼Œå½“ä½ åˆ›å»ºè‡ªå·±çš„â€œclassâ€æˆ–ä»…éœ€è¦è‡ªå®šä¹‰å¯¹è±¡çš„åºåˆ—åŒ–è¡¨ç¤ºå½¢å¼æ—¶ï¼Œä½ è¦åšçš„å°±æ˜¯ä½¿ç”¨`toObject`æ–¹æ³•-å®Œå…¨æ›¿æ¢å®ƒæˆ–å¯¹å…¶è¿›è¡Œæ‰©å±•ã€‚è®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹:
```js
var rect = new fabric.Rect();
rect.toObject = function() {
  return { name: 'trololo' };
};
canvas.add(rect);
console.log(JSON.stringify(canvas));
```
..æ—¥å¿—å¦‚ä¸‹:

```json
{"objects":[{"name":"trololo"}],"background":"rgba(0, 0, 0, 0)"}
```
å¦‚ä½ æ‰€è§ï¼Œobjectsæ•°ç»„ç°åœ¨æœ‰äº†çŸ©å½¢çš„è‡ªå®šä¹‰è¡¨ç¤ºã€‚è¿™ç§è¦†ç›–å¯èƒ½ä¸æ˜¯å¾ˆæœ‰ç”¨ï¼ˆå°½ç®¡æåˆ°äº†é‡ç‚¹ï¼‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨é¢å¤–çš„å±æ€§æ¥æ‰©å±•çŸ©å½¢çš„toObjectæ–¹æ³•å§ã€‚

```js
var rect = new fabric.Rect();

rect.toObject = (function(toObject) {
  return function() {
    return fabric.util.object.extend(toObject.call(this), {
      name: this.name
    });
  };
})(rect.toObject);

canvas.add(rect);

rect.name = 'trololo';

console.log(JSON.stringify(canvas));
```
..æ—¥å¿—è¾“å‡ºå¦‚ä¸‹:
```json
{"objects":[{"type":"rect","left":0,"top":0,"width":0,"height":0,"fill":"rgb(0,0,0)","overlayFill":null,"stroke":null,"strokeWidth":1,"strokeDashArray":null,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"selectable":true,"hasControls":true,"hasBorders":true,"hasRotatingPoint":false,"transparentCorners":true,"perPixelTargetFind":false,"rx":0,"ry":0,**"name":"trololo"**}],"background":"rgba(0, 0, 0, 0)"}
```
æˆ‘ä»¬ä½¿ç”¨é™„åŠ å±æ€§â€œnameâ€æ‰©å±•äº†å¯¹è±¡ç°æœ‰çš„`toObject`æ–¹æ³•ï¼Œå› æ­¤è¯¥å±æ€§ç°åœ¨æ˜¯`toObject`è¾“å‡ºçš„ä¸€éƒ¨åˆ†ï¼Œä»¥canvas JSONè¡¨ç¤ºå½¢å¼å‡ºç°ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœä½ åƒè¿™æ ·æ‰©å±•å¯¹è±¡ï¼Œåˆ™è¿˜éœ€è¦ç¡®ä¿å¯¹è±¡çš„â€œclassâ€ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸º`fabric.Rect`ï¼‰åœ¨â€œ statePropertiesâ€æ•°ç»„ä¸­å…·æœ‰æ­¤å±æ€§ï¼Œä»¥ä¾¿ä»å­—ç¬¦ä¸²å½¢å¼ä¸­åŠ è½½ç”»å¸ƒå¹¶å°†å…¶è§£æå¹¶æ­£ç¡®æ·»åŠ åˆ°å¯¹è±¡ã€‚ 

ä½ å¯ä»¥å°†å¯¹è±¡æ ‡è®°ä¸ºä¸å¯å¯¼å‡ºï¼Œå°†`excludeFromExport`è®¾ç½®ä¸º`true`ã€‚è¿™æ ·ï¼Œä½ åœ¨ç”»å¸ƒä¸Šå¯ä»¥æ‹¥æœ‰çš„ä¸€äº›è¾…åŠ©å¯¹è±¡å°†ä¸ä¼šåœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¿å­˜ã€‚

#### toSVG æ–¹æ³•

å¦ä¸€ç§æœ‰æ•ˆçš„åŸºäºæ–‡æœ¬çš„ç”»å¸ƒè¡¨ç¤ºå½¢å¼ä¸ºSVGæ ¼å¼ã€‚ç”±äºFabricä¸“æ³¨äºåœ¨ç”»å¸ƒä¸Šè¿›è¡ŒSVGè§£æå’Œæ¸²æŸ“ï¼Œå› æ­¤åªæœ‰å°†å…¶è®¾ä¸ºåŒå‘è¿‡ç¨‹å¹¶æä¾›ç”»å¸ƒåˆ°SVGçš„è½¬æ¢æ‰æœ‰æ„ä¹‰ã€‚è®©æˆ‘ä»¬å°†ç›¸åŒçš„çŸ©å½¢æ·»åŠ åˆ°ç”»å¸ƒä¸Šï¼Œçœ‹çœ‹toSVGæ–¹æ³•è¿”å›äº†å“ªç§è¡¨ç¤ºå½¢å¼ï¼š

```js
canvas.add(new fabric.Rect({
  left: 50,
  top: 50,
  height: 20,
  width: 20,
  fill: 'green'
}));
console.log(canvas.toSVG());
```
..æ—¥å¿—è¾“å‡ºå¦‚ä¸‹:
```xml
<?xml version="1.0" standalone="no" ?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="800" height="700" xml:space="preserve"><desc>Created with Fabric.js 0.9.21</desc><rect x="-10" y="-10" rx="0" ry="0" width="20" height="20" style="stroke: none; stroke-width: 1; stroke-dasharray: ; fill: green; opacity: 1;" transform="translate(50 50)" /></svg>
```
å°±åƒ`toJSON`å’Œ`toObject`ä¸€æ ·ï¼Œ`toSVG`ï¼ˆåœ¨ç”»å¸ƒä¸Šè°ƒç”¨æ—¶ï¼‰å°†å…¶é€»è¾‘å§”æ‰˜ç»™æ¯ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œå¹¶ä¸”æ¯ä¸ªå•ç‹¬çš„å¯¹è±¡éƒ½æœ‰å…¶è‡ªå·±çš„`toSVG`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸“ç”¨äºå¯¹è±¡ç±»å‹ã€‚å¦‚æœä½ éœ€è¦ä¿®æ”¹æˆ–æ‰©å±•å¯¹è±¡çš„SVGè¡¨ç¤ºå½¢å¼ï¼Œåˆ™å¯ä»¥ä½¿ç”¨`toSVG`æ¥å®Œæˆä¸`toObject`ç›¸åŒçš„æ“ä½œã€‚ 

ä¸Fabricä¸“æœ‰çš„`toObject `/ `toJSON`ç›¸æ¯”ï¼ŒSVGè¡¨ç¤ºçš„ä¼˜ç‚¹æ˜¯ä½ å¯ä»¥å°†å…¶æ”¾å…¥ä»»ä½•æ”¯æŒSVGçš„æ¸²æŸ“å™¨ï¼ˆæµè§ˆå™¨ï¼Œåº”ç”¨ç¨‹åºï¼Œæ‰“å°æœºï¼Œç…§ç›¸æœºç­‰ï¼‰ä¸­ï¼Œå¹¶ä¸”åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ä½†æ˜¯ï¼Œä½¿ç”¨`toObject` /` toJSON`ï¼Œä½ é¦–å…ˆéœ€è¦å°†å…¶åŠ è½½åˆ°ç”»å¸ƒä¸Šã€‚

è¯´åˆ°å°†å†…å®¹åŠ è½½åˆ°ç”»å¸ƒä¸Šï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥å°†ç”»å¸ƒåºåˆ—åŒ–ä¸ºé«˜æ•ˆçš„æ–‡æœ¬å—äº†ï¼Œæˆ‘ä»¬å°†å¦‚ä½•é‡æ–°åŠ è½½åˆ°ç”»å¸ƒä¸Šå‘¢ï¼Ÿ
### ååºåˆ—åŒ–, SVG è§£æå™¨

ä¸åºåˆ—åŒ–ç±»ä¼¼ï¼Œæœ‰ä¸¤ç§ä»å­—ç¬¦ä¸²åŠ è½½ç”»å¸ƒçš„æ–¹æ³•ï¼šä»JSONè¡¨ç¤ºæˆ–ä»SVGåŠ è½½ã€‚ä½¿ç”¨JSONè¡¨ç¤ºå½¢å¼æ—¶ï¼Œæœ‰`fabric.Canvasï¼ƒloadFromJSON`å’Œ`fabric.Canvasï¼ƒloadFromDatalessJSON`æ–¹æ³•ã€‚ä½¿ç”¨SVGæ—¶ï¼Œæœ‰`fabric.loadSVGFromURL`å’Œ`fabric.loadSVGFromString`ã€‚ 

è¯·æ³¨æ„ï¼Œå‰ä¸¤ä¸ªæ–¹æ³•æ˜¯å®ä¾‹æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨canvaså®ä¾‹ä¸Šè°ƒç”¨ï¼Œè€Œåä¸¤ä¸ªæ–¹æ³•æ˜¯é™æ€æ–¹æ³•ï¼Œå¯ä»¥åœ¨â€œ fabricâ€å¯¹è±¡ä¸Šè€Œä¸æ˜¯åœ¨ç”»å¸ƒä¸Šè°ƒç”¨ã€‚ è¿™äº›æ–¹æ³•æ²¡ä»€ä¹ˆå¯è¯´çš„ã€‚å®ƒä»¬çš„å·¥ä½œä¸ä½ æœŸæœ›çš„å®Œå…¨ä¸€æ ·ã€‚è®©æˆ‘ä»¬ä»¥ç”»å¸ƒä¸Šçš„å…ˆå‰JSONè¾“å‡ºä¸ºä¾‹ï¼Œå¹¶å°†å…¶åŠ è½½åˆ°å¹²å‡€çš„ç”»å¸ƒä¸Šï¼š

```js
var canvas = new fabric.Canvas();

canvas.loadFromJSON('{"objects":[{"type":"rect","left":50,"top":50,"width":20,"height":20,"fill":"green","overlayFill":null,"stroke":null,"strokeWidth":1,"strokeDashArray":null,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"selectable":true,"hasControls":true,"hasBorders":true,"hasRotatingPoint":false,"transparentCorners":true,"perPixelTargetFind":false,"rx":0,"ry":0},{"type":"circle","left":100,"top":100,"width":100,"height":100,"fill":"red","overlayFill":null,"stroke":null,"strokeWidth":1,"strokeDashArray":null,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"selectable":true,"hasControls":true,"hasBorders":true,"hasRotatingPoint":false,"transparentCorners":true,"perPixelTargetFind":false,"radius":50}],"background":"rgba(0, 0, 0, 0)"}');
```
..ä¸¤ä¸ªç‰©ä½“â€œç¥å¥‡åœ°â€å‡ºç°åœ¨ç”»å¸ƒä¸Š:

![](/article_assets/3_5.png)

å› æ­¤ï¼Œä»å­—ç¬¦ä¸²åŠ è½½ç”»å¸ƒéå¸¸å®¹æ˜“ã€‚ä½†æ˜¯é‚£ç§çœ‹èµ·æ¥å¾ˆå¥‡æ€ªçš„`loadFromDatalessJSON`æ–¹æ³•å‘¢ï¼Ÿä¸æˆ‘ä»¬åˆšåˆšä½¿ç”¨çš„`loadFromJSON`æœ‰ä»€ä¹ˆä¸åŒï¼Ÿä¸ºäº†äº†è§£ä¸ºä»€ä¹ˆéœ€è¦æ­¤æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹å…·æœ‰æˆ–å¤šæˆ–å°‘å¤æ‚è·¯å¾„å¯¹è±¡çš„åºåˆ—åŒ–ç”»å¸ƒã€‚åƒè¿™ä¸ªï¼š

![](/article_assets/3_6.png)

..æ­¤å½¢çŠ¶çš„JSON.stringifyï¼ˆcanvasï¼‰è¾“å‡ºä¸ºï¼š
```json
{"objects":[{"type":"path","left":184,"top":177,"width":175,"height":151,"fill":"#231F20","overlayFill":null,"stroke":null,"strokeWidth":1,"strokeDashArray":null,"scaleX":1,"scaleY":1,"angle":-19,"flipX":false,"flipY":false,"opacity":1,"selectable":true,"hasControls":true,"hasBorders":true,"hasRotatingPoint":false,"transparentCorners":true,"perPixelTargetFind":false,"path":[["M",39.502,61.823],["c",-1.235,-0.902,-3.038,-3.605,-3.038,-3.605],["s",0.702,0.4,3.907,1.203],["c",3.205,0.8,7.444,-0.668,10.114,-1.97],["c",2.671,-1.302,7.11,-1.436,9.448,-1.336],["c",2.336,0.101,4.707,0.602,4.373,2.036],["c",-0.334,1.437,-5.742,3.94,-5.742,3.94],["s",0.4,0.334,1.236,0.334],["c",0.833,0,6.075,-1.403,6.542,-4.173],["s",-1.802,-8.377,-3.272,-9.013],["c",-1.468,-0.633,-4.172,0,-4.172,0],["c",4.039,1.438,4.941,6.176,4.941,6.176],["c",-2.604,-1.504,-9.279,-1.234,-12.619,0.501],["c",-3.337,1.736,-8.379,2.67,-10.083,2.503],["c",-1.701,-0.167,-3.571,-1.036,-3.571,-1.036],["c",1.837,0.034,3.239,-2.669,3.239,-2.669],["s",-2.068,2.269,-5.542,0.434],["c",-3.47,-1.837,-1.704,-8.18,-1.704,-8.18],["s",-2.937,5.909,-1,9.816],["C",34.496,60.688,39.502,61.823,39.502,61.823],["z"],["M",77.002,40.772],["c",0,0,-1.78,-5.03,-2.804,-8.546],["l",-1.557,8.411],["l",1.646,1.602],["c",0,0,0,-0.622,-0.668,-1.691],["C",72.952,39.48,76.513,40.371,77.002,40.772],["z"],["M",102.989,86.943],["M",102.396,86.424],["c",0.25,0.22,0.447,0.391,0.594,0.519],["C",102.796,86.774,102.571,86.578,102.396,86.424],["z"],["M",169.407,119.374],["c",-0.09,-5.429,-3.917,-3.914,-3.917,-2.402],["c",0,0,-11.396,1.603,-13.086,-6.677],["c",0,0,3.56,-5.43,1.69,-12.461],["c",-0.575,-2.163,-1.691,-5.337,-3.637,-8.605],["c",11.104,2.121,21.701,-5.08,19.038,-15.519],["c",-3.34,-13.087,-19.63,-9.481,-24.437,-9.349],["c",-4.809,0.135,-13.486,-2.002,-8.011,-11.618],["c",5.473,-9.613,18.024,-5.874,18.024,-5.874],["c",-2.136,0.668,-4.674,4.807,-4.674,4.807],["c",9.748,-6.811,22.301,4.541,22.301,4.541],["c",-3.097,-13.678,-23.153,-14.636,-30.041,-12.635],["c",-4.286,-0.377,-5.241,-3.391,-3.073,-6.637],["c",2.314,-3.473,10.503,-13.976,10.503,-13.976],["s",-2.048,2.046,-6.231,4.005],["c",-4.184,1.96,-6.321,-2.227,-4.362,-6.854],["c",1.96,-4.627,8.191,-16.559,8.191,-16.559],["c",-1.96,3.207,-24.571,31.247,-21.723,26.707],["c",2.85,-4.541,5.253,-11.93,5.253,-11.93],["c",-2.849,6.943,-22.434,25.283,-30.713,34.274],["s",-5.786,19.583,-4.005,21.987],["c",0.43,0.58,0.601,0.972,0.62,1.232],["c",-4.868,-3.052,-3.884,-13.936,-0.264,-19.66],["c",3.829,-6.053,18.427,-20.207,18.427,-20.207],["v",-1.336],["c",0,0,0.444,-1.513,-0.089,-0.444],["c",-0.535,1.068,-3.65,1.245,-3.384,-0.889],["c",0.268,-2.137,-0.356,-8.549,-0.356,-8.549],["s",-1.157,5.789,-2.758,5.61],["c",-1.603,-0.179,-2.493,-2.672,-2.405,-5.432],["c",0.089,-2.758,-1.157,-9.702,-1.157,-9.702],["c",-0.8,11.75,-8.277,8.011,-8.277,3.74],["c",0,-4.274,-4.541,-12.82,-4.541,-12.82],["s",2.403,14.421,-1.336,14.421],["c",-3.737,0,-6.944,-5.074,-9.879,-9.882],["C",78.161,5.874,68.279,0,68.279,0],["c",13.428,16.088,17.656,32.111,18.397,44.512],["c",-1.793,0.422,-2.908,2.224,-2.908,2.224],["c",0.356,-2.847,-0.624,-7.745,-1.245,-9.882],["c",-0.624,-2.137,-1.159,-9.168,-1.159,-9.168],["c",0,2.67,-0.979,5.253,-2.048,9.079],["c",-1.068,3.828,-0.801,6.054,-0.801,6.054],["c",-1.068,-2.227,-4.271,-2.137,-4.271,-2.137],["c",1.336,1.783,0.177,2.493,0.177,2.493],["s",0,0,-1.424,-1.601],["c",-1.424,-1.603,-3.473,-0.981,-3.384,0.265],["c",0.089,1.247,0,1.959,-2.849,1.959],["c",-2.846,0,-5.874,-3.47,-9.078,-3.116],["c",-3.206,0.356,-5.521,2.137,-5.698,6.678],["c",-0.179,4.541,1.869,5.251,1.869,5.251],["c",-0.801,-0.443,-0.891,-1.067,-0.891,-3.473],...
```
..é‚£åªæ˜¯æ•´ä¸ªè¾“å‡ºçš„å°éƒ¨åˆ†ï¼

è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿå¥½å§ï¼Œäº‹å®è¯æ˜ï¼Œè¿™ä¸ª`fabric.Path`å®ä¾‹-è¿™ç§å½¢çŠ¶-å®é™…ä¸Šç”±æ•°ç™¾æ¡è´å¡å°”æ›²çº¿ç»„æˆï¼Œè¿™äº›è´å¡å°”æ›²çº¿å†³å®šäº†æ¸²æŸ“çš„ç²¾ç¡®ç¨‹åº¦ã€‚ JSONè¡¨ç¤ºå½¢å¼ä¸­çš„æ‰€æœ‰è¿™äº›[â€œ câ€ï¼Œ0,2.67ï¼Œ-0.979,5.253ï¼Œ-2.048,9.079]å—å‡å¯¹åº”äºæ­¤ç±»æ›²çº¿ä¸­çš„æ¯æ¡æ›²çº¿ã€‚è€Œä¸”å½“å®ƒä»¬æœ‰æ•°ç™¾ä¸ªï¼ˆç”šè‡³æ•°åƒä¸ªï¼‰æ—¶ï¼Œç”»å¸ƒè¡¨ç¤ºå½¢å¼æœ€ç»ˆä¼šå˜å¾—éå¸¸åºå¤§ã€‚ 

è¯¥æ€ä¹ˆåŠï¼Ÿ 

è¿™æ˜¯`fabric.Canvasï¼ƒtoDatalessJSON`æ´¾ä¸Šç”¨åœºçš„æ—¶å€™ã€‚è®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹ï¼š

```js
canvas.item(0).sourcePath = '/assets/dragon.svg';
console.log(JSON.stringify(canvas.toDatalessJSON()));
```
..æ—¥å¿—è¾“å‡ºå¦‚ä¸‹:
```json
{"objects":[{"type":"path","left":143,"top":143,"width":175,"height":151,"fill":"#231F20","overlayFill":null,"stroke":null,"strokeWidth":1,"strokeDashArray":null,"scaleX":1,"scaleY":1,"angle":-19,"flipX":false,"flipY":false,"opacity":1,"selectable":true,"hasControls":true,"hasBorders":true,"hasRotatingPoint":false,"transparentCorners":true,"perPixelTargetFind":false,**"path":"/assets/dragon.svg"**}],"background":"rgba(0, 0, 0, 0)"}
```
å¥½å§ï¼Œé‚£è‚¯å®šå¾ˆä¸é”™ï¼æ‰€ä»¥å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿè¯·æ³¨æ„ï¼Œåœ¨è°ƒç”¨`toDatalessJSON`ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸ºpathï¼ˆé¾™å½¢ï¼‰å¯¹è±¡æä¾›å€¼ä¸ºâ€œ /assets/dragon.svgâ€çš„â€œ sourcePathâ€å±æ€§ã€‚ç„¶åï¼Œå½“æˆ‘ä»¬è°ƒç”¨`toDatalessJSON`æ—¶ï¼Œå…ˆå‰è¾“å‡ºä¸­çš„æ•´ä¸ªå·¨å¤§è·¯å¾„å­—ç¬¦ä¸²ï¼ˆæ•°ç™¾æ¡è·¯å¾„å‘½ä»¤ï¼‰è¢«æ›¿æ¢ä¸ºå•ä¸ªâ€œ dragon.svgâ€å­—ç¬¦ä¸²ã€‚ä½ å¯ä»¥çœ‹åˆ°ä¸Šé¢çªå‡ºæ˜¾ç¤ºçš„å†…å®¹ã€‚ 

åœ¨å¤„ç†è®¸å¤šå¤æ‚å½¢çŠ¶æ—¶ï¼Œ`toDatalessJSON`å…è®¸æˆ‘ä»¬è¿›ä¸€æ­¥å‡å°‘ç”»å¸ƒè¡¨ç¤ºï¼Œå¹¶ä½¿ç”¨æŒ‡å‘SVGçš„ç®€å•é“¾æ¥æ›¿æ¢å·¨å¤§çš„è·¯å¾„æ•°æ®è¡¨ç¤ºã€‚ 

ç°åœ¨å›åˆ°`loadFromDatalessJSON`æ–¹æ³•...ä½ å¯èƒ½ä¼šçŒœåˆ°ï¼Œå®ƒåªæ˜¯å…è®¸ä»æ— æ•°æ®ç‰ˆæœ¬çš„ç”»å¸ƒè¡¨ç¤ºä¸­åŠ è½½ç”»å¸ƒã€‚ `loadFromDatalessJSON`éå¸¸äº†è§£å¦‚ä½•è·å–é‚£äº›â€œpathâ€å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚â€œ /assets/dragon.svgâ€ï¼‰ï¼ŒåŠ è½½å®ƒä»¬å¹¶å°†å®ƒä»¬ç”¨ä½œç›¸åº”è·¯å¾„å¯¹è±¡çš„æ•°æ®ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹SVGåŠ è½½æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æˆ–URLï¼š
```js
fabric.loadSVGFromString('...', function(objects, options) {
  var obj = fabric.util.groupSVGElements(objects, options);
  canvas.add(obj).renderAll();
});
```
ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯SVGå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•°ã€‚å½“è§£æå’ŒåŠ è½½SVGå¹¶æ¥æ”¶2ä¸ªå‚æ•°ï¼ˆobjectså’Œoptionsï¼‰æ—¶ï¼Œå°†è°ƒç”¨è¯¥å›è°ƒã€‚ objectsåŒ…å«ä»SVGè§£æçš„å¯¹è±¡æ•°ç»„-paths,path groupsï¼ˆç”¨äºå¤æ‚å¯¹è±¡ï¼‰,images,textç­‰ã€‚ä¸ºäº†å°†æ‰€æœ‰è¿™äº›å¯¹è±¡åˆ†ç»„ä¸ºä¸€ä¸ªå†…èšçš„é›†åˆï¼Œå¹¶ä½¿å…¶ä¸SVGæ–‡æ¡£ä¸­çš„å¤–è§‚ç›¸åŒï¼Œæˆ‘ä»¬ä½¿ç”¨`fabric.util.groupSVGElements`ä¼ é€’å¯¹è±¡å’Œé€‰é¡¹ã€‚ä½œä¸ºå›æŠ¥ï¼Œæˆ‘ä»¬è·å¾—`fabric.Path`æˆ–`fabric.Group`çš„å®ä¾‹ï¼Œç„¶åå¯ä»¥å°†å…¶æ·»åŠ åˆ°ç”»å¸ƒä¸Šã€‚ 

`fabric.loadSVGFromURL`çš„å·¥ä½œæ–¹å¼ç›¸åŒï¼Œåªä¸è¿‡ä½ ä¼ é€’çš„æ˜¯åŒ…å«URLè€Œä¸æ˜¯SVGå†…å®¹çš„å­—ç¬¦ä¸²ã€‚è¯·æ³¨æ„ï¼ŒFabricå°†å°è¯•é€šè¿‡`XMLHttpRequest`è·å–è¯¥URLï¼Œå› æ­¤SVGéœ€è¦ç¬¦åˆé€šå¸¸çš„SOPè§„åˆ™ã€‚
### å­ç±»åŒ–

ç”±äºFabricæ˜¯æŒ‰ç…§çœŸæ­£çš„é¢å‘å¯¹è±¡çš„æ–¹å¼æ„å»ºçš„ï¼Œå› æ­¤å¯ä»¥ä½¿å­ç±»åŒ–å’Œæ‰©å±•å˜å¾—ç®€å•è‡ªç„¶ã€‚ä»æœ¬ç³»åˆ—çš„ç¬¬1éƒ¨åˆ†ä¸­å¯ä»¥çŸ¥é“ï¼ŒFabricä¸­å­˜åœ¨å¯¹è±¡çš„ç°æœ‰å±‚æ¬¡ç»“æ„ã€‚æ‰€æœ‰2Då¯¹è±¡ï¼ˆpaths,images,textç­‰ï¼‰éƒ½ä»fabric.Objectç»§æ‰¿ï¼Œå¹¶ä¸”æŸäº›â€œç±»â€ï¼ˆä¾‹å¦‚`fabric.IText`ï¼‰ç”šè‡³å½¢æˆ3çº§ç»§æ‰¿ã€‚ é‚£ä¹ˆï¼Œæˆ‘ä»¬å°†å¦‚ä½•åœ¨Fabricä¸­å¯¹ç°æœ‰çš„â€œç±»â€ä¹‹ä¸€è¿›è¡Œå­ç±»åŒ–å‘¢ï¼Ÿä¹Ÿè®¸ç”šè‡³åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„ï¼Ÿ å¯¹äºæ­¤ä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦`fabric.util.createClass`å®ç”¨ç¨‹åºæ–¹æ³•ã€‚` createClass`åªæ˜¯å¯¹JavascriptåŸå‹ç»§æ‰¿çš„ç®€å•æŠ½è±¡ã€‚

è®©æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„Point â€œ ç±»â€ï¼š

```js
var Point = fabric.util.createClass({
  initialize: function(x, y) {
    this.x = x || 0;
    this.y = y || 0;
  },
  toString: function() {
    return this.x + '/' + this.y;
  }
});
```
`createClass` æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨è¯¥å¯¹è±¡çš„å±æ€§åˆ›å»ºå…·æœ‰å®ä¾‹çº§å±æ€§çš„â€œç±»â€ã€‚å”¯ä¸€ç»è¿‡ç‰¹æ®Šå¤„ç†çš„å±æ€§æ˜¯â€œåˆå§‹åŒ–â€ï¼Œå®ƒç”¨ä½œæ„é€ å‡½æ•°ã€‚å› æ­¤ï¼Œç°åœ¨åˆå§‹åŒ–Pointæ—¶ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå…·æœ‰â€œ xâ€å’Œâ€œ yâ€å±æ€§ä»¥åŠâ€œ toStringâ€æ–¹æ³•çš„å®ä¾‹ï¼š
```js
var point = new Point(10, 20);

point.x; // 10
point.y; // 20

point.toString(); // "10/20"
```
å¦‚æœæˆ‘ä»¬è¦åˆ›å»ºâ€œ Pointâ€ç±»çš„å­çº§ï¼ˆæ¯”å¦‚è¯´ä¸€ä¸ªå½©è‰²çš„ç‚¹ï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨createClassï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```js
var ColoredPoint = fabric.util.createClass(Point, {
  initialize: function(x, y, color) {
    this.callSuper('initialize', x, y);
    this.color = color || '#000';
  },
  toString: function() {
    return this.callSuper('toString') + ' (color: ' + this.color + ')';
  }
});
```
è¯·æ³¨æ„ï¼Œç°åœ¨å¦‚ä½•å°†å…·æœ‰å®ä¾‹çº§å±æ€§çš„å¯¹è±¡ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ¥æ”¶Pointâ€œç±»â€ï¼Œè¯¥ç‚¹å‘Šè¯‰`createClass`å°†è¯¥ç‚¹ç”¨ä½œè¯¥ç±»çš„çˆ¶â€œç±»â€ã€‚ä¸ºäº†é¿å…é‡å¤ï¼Œæˆ‘ä»¬ä½¿ç”¨`callSuper`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è°ƒç”¨çˆ¶â€œç±»â€çš„æ–¹æ³•ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬è¦æ›´æ”¹`Point`ï¼Œåˆ™æ›´æ”¹ä¹Ÿå°†ä¼ æ’­åˆ°`ColoredPoint`ã€‚è¦æŸ¥çœ‹`ColoredPoint`çš„å®é™…æ•ˆæœï¼š

```js
var redPoint = new ColoredPoint(15, 33, '#f55');

redPoint.x; // 15
redPoint.y; // 33
redPoint.color; // "#f55"

redPoint.toString(); "15/33 (color: #f55)"
```
ç°åœ¨æˆ‘ä»¬å¼€å§‹åˆ›å»ºè‡ªå·±çš„â€œç±»â€å’Œâ€œå­ç±»â€ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä¸å·²ç»å­˜åœ¨çš„Fabricä¸€èµ·ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`LabeledRect`â€œç±»â€ï¼Œè¯¥ç±»å®é™…ä¸Šæ˜¯ä¸€ä¸ªå…·æœ‰æŸç§ä¸ä¹‹å…³è”çš„æ ‡ç­¾çš„çŸ©å½¢ã€‚å½“åœ¨ç”»å¸ƒä¸Šæ¸²æŸ“æ—¶ï¼Œè¯¥æ ‡ç­¾å°†è¢«è¡¨ç¤ºä¸ºçŸ©å½¢å†…çš„æ–‡æœ¬ã€‚ä¸ä¸Šä¸€ä¸ªå¸¦æœ‰åœ†åœˆå’Œæ–‡å­—çš„å°ç»„ç¤ºä¾‹ç›¸ä¼¼ã€‚åœ¨ä½¿ç”¨Fabricæ—¶ï¼Œä½ ä¼šæ³¨æ„åˆ°å¯ä»¥é€šè¿‡ä½¿ç”¨ç»„æˆ–ä½¿ç”¨è‡ªå®šä¹‰ç±»æ¥å®ç°è¿™æ ·çš„ç»„åˆæŠ½è±¡ã€‚

```js
var LabeledRect = fabric.util.createClass(fabric.Rect, {

  type: 'labeledRect',
  // initialize can be of type function(options) or function(property, options), like for text.
  // no other signatures allowed.
  initialize: function(options) {
    options || (options = { });

    this.callSuper('initialize', options);
    this.set('label', options.label || '');
  },

  toObject: function() {
    return fabric.util.object.extend(this.callSuper('toObject'), {
      label: this.get('label')
    });
  },

  _render: function(ctx) {
    this.callSuper('\_render', ctx);

    ctx.font = '20px Helvetica';
    ctx.fillStyle = '#333';
    ctx.fillText(this.label, -this.width/2, -this.height/2 + 20);
  }
});
```
ä¼¼ä¹è¿™é‡Œå‘ç”Ÿäº†å¾ˆå¤šäº‹æƒ…ï¼Œä½†æ˜¯å®é™…ä¸Šå¾ˆç®€å•ã€‚ 

é¦–å…ˆï¼Œæˆ‘ä»¬å°†çˆ¶â€œç±»â€æŒ‡å®šä¸º`fabric.Rect`ï¼Œä»¥åˆ©ç”¨å…¶æ¸²æŸ“åŠŸèƒ½ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰â€œ typeâ€å±æ€§ï¼Œå°†å…¶è®¾ç½®ä¸ºâ€œ labeledRectâ€ã€‚è¿™åªæ˜¯ä¸ºäº†ä¿æŒä¸€è‡´æ€§ï¼Œå› ä¸ºæ‰€æœ‰Fabricå¯¹è±¡éƒ½å…·æœ‰typeå±æ€§ï¼ˆçŸ©å½¢ï¼Œåœ†å½¢ï¼Œè·¯å¾„ï¼Œæ–‡æœ¬ç­‰ï¼‰ã€‚ç„¶åï¼Œå·²ç»ç†Ÿæ‚‰äº†æ„é€ å‡½æ•°ï¼ˆ`initialize`ï¼‰ï¼Œåœ¨è¯¥æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨`callSuper`ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°†å¯¹è±¡çš„æ ‡ç­¾è®¾ç½®ä¸ºé€šè¿‡é€‰é¡¹ä¼ é€’çš„ä»»ä½•å€¼ã€‚æœ€åï¼Œå‰©ä¸‹2ç§æ–¹æ³•-`toObject`å’Œ`_render`ã€‚å¦‚ä½ ä»åºåˆ—åŒ–ä¸€ç« å·²ç»çŸ¥é“çš„ï¼Œ`toObject`è´Ÿè´£å®ä¾‹çš„å¯¹è±¡ï¼ˆå’ŒJSONï¼‰è¡¨ç¤ºã€‚ç”±äº`LabeledRect`å…·æœ‰ä¸å¸¸è§„rectç›¸åŒçš„å±æ€§ï¼Œä½†ä¹Ÿå…·æœ‰æ ‡ç­¾ï¼Œå› æ­¤æˆ‘ä»¬æ‰©å±•äº†çˆ¶å¯¹è±¡çš„`toObject`æ–¹æ³•ï¼Œå¹¶ç®€å•åœ°å‘å…¶ä¸­æ·»åŠ äº†æ ‡ç­¾ã€‚æœ€åä½†å¹¶éæœ€ä¸é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œ`_render`æ–¹æ³•æ˜¯è´Ÿè´£å®é™…ç»˜åˆ¶å®ä¾‹çš„åŸå› ã€‚å…¶ä¸­è¿˜æœ‰å¦ä¸€ä¸ª`callSuper`è°ƒç”¨ï¼Œå®ƒæ˜¯å‘ˆç°çŸ©å½¢çš„å†…å®¹ï¼Œå¦å¤–è¿˜æœ‰3è¡Œæ–‡æœ¬å‘ˆç°é€»è¾‘ã€‚

ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬è¦æ¸²æŸ“è¿™æ ·çš„å¯¹è±¡ï¼š

```js
var labeledRect = new LabeledRect({
  width: 100,
  height: 50,
  left: 100,
  top: 100,
  label: 'test',
  fill: '#faa'
});
canvas.add(labeledRect);
```
..æˆ‘ä»¬ä¼šå¾—åˆ°è¿™ä¸ªï¼š


![](/article_assets/3_7.png)

æ›´æ”¹æ ‡ç­¾å€¼æˆ–ä»»ä½•å…¶ä»–å¸¸è§„çŸ©å½¢å±æ€§æ˜¾ç„¶å¯ä»¥æŒ‰é¢„æœŸå·¥ä½œï¼š
```js
labeledRect.set({
  label: 'trololo',
  fill: '#aaf',
  rx: 10,
  ry: 10
});
```
![](/article_assets/3_8.png)

å½“ç„¶ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œä½ å¯ä»¥éšæ„æ›´æ”¹æ­¤â€œç±»â€çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå°†æŸäº›å€¼è®¾ä¸ºé»˜è®¤å€¼ï¼Œä»¥é¿å…æ¯æ¬¡å°†å®ƒä»¬ä¼ é€’ç»™æ„é€ å‡½æ•°ã€‚æˆ–ä½¿æŸäº›å¯é…ç½®å±æ€§åœ¨å®ä¾‹ä¸Šå¯ç”¨ã€‚å¦‚æœç¡®å®ä½¿å…¶ä»–å±æ€§å¯é…ç½®ï¼Œåˆ™å¯èƒ½è¦åœ¨`toObject`ä¸­è¯´æ˜å®ƒä»¬å¹¶è¿›è¡Œ`initialize`ï¼š

```js
...
initialize: function(options) {
  options || (options = { });

  this.callSuper('initialize', options);

  // give all labeled rectangles fixed width/heigh of 100/50
  **this.set({ width: 100, height: 50 });**

  this.set('label', options.label || '');
}
...
_render: function(ctx) {

  // make font and fill values of labels configurable
  **ctx.font = this.labelFont;
  ctx.fillStyle = this.labelFill;**

  ctx.fillText(this.label, -this.width/2, -this.height/2 + 20);
}
...
```
ä¸ºäº†å…‹éš†å’Œä¿å­˜/è¿˜åŸæ­¤ç±»ï¼Œä½ éœ€è¦æ·»åŠ ä¸€ä¸ªfromObjecté™æ€æ–¹æ³•ï¼Œå¹¶åœ¨å…¶ä¹‹ä¸Šæ·»åŠ è¦æ·»åŠ åˆ°ä¸»fabricObjectçš„å­ç±»ï¼š

```js
// standard options type:
fabric.labeledRect.fromObject = function(object, callback) {
  return fabric.FabricObject.\_fromObject('LabeledRect', object, callback);
}
...
// argument + options type:
// in this example aProp is the property in the object that contains the value
// that goes in someValue in \`new fabric.MyClass(someValue, options)\`
fabric.labeledRect.fromObject = function(object, callback) {
  return fabric.FabricObject.\_fromObject('LabeledRect', object, callback, 'aProp');
}
```
å…³äºè¿™ä¸€ç‚¹ï¼Œæˆ‘æ€»ç»“äº†æœ¬ç³»åˆ—çš„ç¬¬3éƒ¨åˆ†ï¼Œå…¶ä¸­æˆ‘ä»¬æ¢è®¨äº†Fabricçš„ä¸€äº›æ›´é«˜çº§çš„æ–¹é¢ã€‚åœ¨ç»„ï¼Œç±»å’Œï¼ˆåï¼‰åºåˆ—åŒ–çš„å¸®åŠ©ä¸‹ï¼Œä½ å¯ä»¥å°†ä½ çš„åº”ç”¨æå‡åˆ°ä¸€ä¸ªå…¨æ–°çš„æ°´å¹³ã€‚